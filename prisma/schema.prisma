datasource db {
  provider = "postgresql"
  // make sure you already have:
  // url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Route {
  id          Int            @id @default(autoincrement())
  from        String
  to          String
  label       String?        // Optional label for the route
  description String?        // Optional description for the route
  distance    String
  duration    String
  pricing     RoutePricing[] // 1 -> many
}

model RoutePricing {
  id           Int    @id @default(autoincrement())
  passengers   String
  price        Int
  vehicleType  String // The type of vehicle for this pricing

  routeId      Int
  route        Route  @relation(fields: [routeId], references: [id], onDelete: Cascade)
}

model Booking {
  id                   String   @id @default(cuid())
  stripeSessionId      String   @unique

  pickupLocation       String
  pickupAddress        String?
  dropoffLocation      String
  dropoffAddress       String?
  pickupDate           String
  pickupTime           String
  passengers           Int
  luggage              Int
  flightNumber         String?
  childSeat            Boolean

  fullName             String
  email                String
  contactNumber        String

  totalPriceCents      Int
  currency             String

  emailSent            Boolean  @default(false)

  // NEW: booking type + hourly hire fields
  bookingType          String   @default("standard")
  hourlyPickupLocation String?
  hourlyHours          Int?
  hourlyVehicleType    String?

  createdAt            DateTime @default(now())
}

model BookingLead {
  id                   String   @id @default(cuid())

  bookingType           String   // "standard" | "hourly"

  // Standard transfer
  pickupLocation        String?
  pickupAddress         String?
  dropoffLocation       String?
  dropoffAddress        String?

  pickupDate            String?
  pickupTime            String?

  passengers            Int?
  luggage               Int?
  flightNumber          String?
  childSeat             Boolean?

  // Hourly hire
  hourlyPickupLocation  String?
  hourlyHours           Int?
  hourlyVehicleType     String?

  // Contact (MANDATORY for saving)
  fullName              String?
  email                 String?
  contactNumber         String?

  quotedPriceCents      Int?
  currency              String   @default("AUD")

  status                String   @default("draft") // draft | converted

  // UI / device source (NOT marketing attribution)
  source                String?

  /* ----------------------------------------
     MARKETING ATTRIBUTION (UTM)
     Stored ONLY if present in URL
  ---------------------------------------- */
  utmSource             String?
  utmMedium             String?
  utmCampaign           String?
  utmTerm               String?
  utmContent            String?
  utmCapturedAt         DateTime?

  createdAt             DateTime @default(now())
  updatedAt             DateTime @updatedAt
}
